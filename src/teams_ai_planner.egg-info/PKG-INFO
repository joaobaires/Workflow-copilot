Metadata-Version: 2.4
Name: teams-ai-planner
Version: 0.1.0
Summary: Daily action planner that connects to Microsoft Teams, analyzes channel messages via AI, and suggests follow-up actions.
Author: Workflow Copilot
Project-URL: Homepage, https://github.com/example/teams-ai-planner
Requires-Python: >=3.11
Description-Content-Type: text/markdown
Requires-Dist: msal>=1.29.0
Requires-Dist: openai>=1.53.0
Requires-Dist: python-dotenv>=1.0.1
Requires-Dist: pydantic>=2.9.2
Requires-Dist: requests>=2.32.3
Requires-Dist: rich>=13.9.2

# Teams AI Action Planner

This project bootstraps a practical workflow-copilot that connects to Microsoft Teams, scans recent channel messages with AI, and proposes concrete follow-up actions (for example, pinging someone for an update on an open request).

## Features

- Microsoft Graph connector for pulling and posting Teams channel messages.
- AI analyzer (OpenAI-compatible) that turns raw chats into structured action items.
- CLI workflow with optional offline sample data, JSON export, and dry-run sending.
- Modular design so you can swap the LLM provider or extend action execution.

## Getting Started

### 1. Install dependencies

```bash
cd /workspace
python -m venv .venv
source .venv/bin/activate
pip install -e .
```

### 2. Create an Azure AD app registration

1. Register a confidential client with Microsoft Entra ID.
2. Grant **ChannelMessage.Read.All** and **ChannelMessage.Send** application permissions for Microsoft Graph.
3. Create a client secret and record:
   - Tenant (directory) ID
   - Client (application) ID
   - Client secret value

### 3. Configure environment

Create a `.env` file in the repository root:

```
TEAMS_TENANT_ID=xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
TEAMS_CLIENT_ID=xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
TEAMS_CLIENT_SECRET=super-secret-value
OPENAI_API_KEY=sk-...
OPENAI_MODEL=gpt-4o-mini
# Optional overrides:
# OPENAI_BASE_URL=https://my-azure-openai-resource.openai.azure.com/
# PLANNER_TIME_HORIZON_HOURS=6
```

> üîê `Settings.from_env()` (see `src/teams_ai_planner/config.py`) loads `.env` automatically and validates required values.

## Running the planner

```bash
teams-ai-planner \
  --team-id <TEAM_ID> \
  --channel-id <CHANNEL_ID> \
  --focus "Customer escalations" \
  --top 40 \
  --lookback 24
```

What happens:

1. `GraphClient` (`src/teams_ai_planner/graph.py`) retrieves recent channel messages.
2. `ActionPlanAnalyzer` (`src/teams_ai_planner/analyzer.py`) sends them to the configured LLM, requesting JSON-formatted actions.
3. `DailyActionPlanner` (`src/teams_ai_planner/planner.py`) prints the suggested actions in a table and optionally sends follow-ups back to Teams.

### Offline / demo mode

Try the flow without Graph credentials using the bundled sample payload:

```bash
teams-ai-planner --offline-json samples/messages.sample.json --focus "Ops readiness"
```

### Exporting plans

```bash
teams-ai-planner ... --export-json /tmp/plan.json
```

### Sending suggested follow-ups

By default the CLI will **not** send messages, even if the AI proposes them. To enable:

```bash
teams-ai-planner ... --send-followups --force-send
```

Omit `--force-send` to inspect a dry-run preview first.

## Extending

- Swap the LLM provider by editing `ActionPlanAnalyzer` to call Azure OpenAI, Anthropic, etc.
- Add more executors (e.g., create Planner tasks or Jira tickets) by extending `DailyActionPlanner`.
- Wrap the CLI inside a scheduled job or GitHub Action for daily reports.

## Testing checklist

- [ ] `teams-ai-planner --offline-json samples/messages.sample.json` produces a plan.
- [ ] Real Graph credentials fetch channel history successfully.
- [ ] Sending mode works after granting `ChannelMessage.Send`.
- [ ] JSON export file contains the proposed actions.

## Troubleshooting

- `Missing required environment variable ...`: ensure `.env` is populated and sourced.
- `Forbidden (403)` from Graph: confirm the app has admin-consented permissions.
- LLM JSON parse errors: enable verbose logging and inspect the raw response; sometimes raising temperature slightly can help.
